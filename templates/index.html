<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solver Ecuaciones Diferenciales</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f4f4f9; }
        h1 { text-align: center; color: #333; }
        .input-group { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; justify-content: center; align-items: center; gap: 10px; flex-wrap: wrap;}
        input { padding: 10px; width: 60px; text-align: center; font-size: 1.2em; border: 1px solid #ddd; border-radius: 4px;}
        button { padding: 10px 20px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1em; }
        button:hover { background-color: #218838; }
        #resultados { margin-top: 20px; }
        .paso { background: white; margin-bottom: 15px; padding: 15px; border-left: 5px solid #007bff; border-radius: 4px; opacity: 0; transform: translateY(20px); transition: all 0.5s ease; }
        .paso.visible { opacity: 1; transform: translateY(0); }
        .paso h3 { margin-top: 0; color: #007bff; }
    </style>
</head>
<body>

    <h1>Solver EDO 2do Orden</h1>
    <p style="text-align: center;">Forma: \( a y'' + b y' + c y = 0 \)</p>

    <div class="input-group">
        <input type="number" id="valA" placeholder="a" value="1"> \( y'' + \)
        <input type="number" id="valB" placeholder="b" value="5"> \( y' + \)
        <input type="number" id="valC" placeholder="c" value="6"> \( y = 0 \)
        <button onclick="resolver()">Resolver Paso a Paso</button>
    </div>

    <div id="resultados"></div>

    <script>
        async function resolver() {
            const a = document.getElementById('valA').value;
            const b = document.getElementById('valB').value;
            const c = document.getElementById('valC').value;
            const contenedor = document.getElementById('resultados');
            contenedor.innerHTML = ""; // Limpiar anterior

            if(a == 0) { alert("Si 'a' es 0, no es de segundo orden."); return; }

            const response = await fetch('/resolver', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ a, b, c })
            });

            const data = await response.json();

            if (data.status === 'success') {
                data.pasos.forEach((paso, index) => {
                    setTimeout(() => {
                        const div = document.createElement('div');
                        div.className = 'paso';
                        div.innerHTML = `<h3>${paso.titulo}</h3><p>${paso.texto}</p>`;
                        contenedor.appendChild(div);
                        
                        // Renderizar MathJax de nuevo para el nuevo contenido
                        MathJax.typesetPromise([div]).then(() => {
                            div.classList.add('visible');
                        });
                        
                    }, index * 800); // 800ms de retraso entre cada paso
                });
            } else {
                contenedor.innerHTML = `<p style="color:red">Error: ${data.message}</p>`;
            }
        }
    </script>
</body>
</html>
